class AutismKnowledgeBase {
  static const Map<String, Map<String, dynamic>> _knowledge = {
    'definicao': {
      'keywords': ['o que Ã©', 'que Ã©', 'definiÃ§Ã£o', 'conceito', 'autismo', 'tea'],
      'response': 'ğŸ§  **TEA (Transtorno do Espectro Autista)**\n\nÃ‰ uma condiÃ§Ã£o neurolÃ³gica que afeta:\nâ€¢ **ComunicaÃ§Ã£o** - verbal e nÃ£o-verbal\nâ€¢ **InteraÃ§Ã£o social** - relacionamentos\nâ€¢ **Comportamentos** - padrÃµes repetitivos\n\nğŸ’™ NÃ£o Ã© doenÃ§a - Ã© uma forma diferente de processar o mundo!',
      'follow_up': ['sintomas', 'diagnostico', 'causas']
    },
    
    'sintomas_precoces': {
      'keywords': ['sintomas', 'sinais', 'identificar', 'como saber', 'primeiros sinais', 'bebÃª', 'crianÃ§a pequena'],
      'response': 'ğŸ‘¶ **Sinais Precoces (0-3 anos)**\n\n**ComunicaÃ§Ã£o:**\nâ€¢ Pouco contato visual\nâ€¢ NÃ£o responde ao nome\nâ€¢ Atraso na fala ou perda de palavras\nâ€¢ NÃ£o aponta para mostrar interesse\n\n**Social:**\nâ€¢ NÃ£o sorri socialmente\nâ€¢ Prefere brincar sozinho\nâ€¢ NÃ£o imita gestos\n\n**Comportamento:**\nâ€¢ Movimentos repetitivos\nâ€¢ FixaÃ§Ã£o em objetos\nâ€¢ ResistÃªncia a mudanÃ§as\n\nâš ï¸ **Importante:** Apenas profissionais podem diagnosticar!',
      'follow_up': ['diagnostico', 'profissionais', 'quando_procurar']
    },
    
    'sintomas_escolares': {
      'keywords': ['escola', 'sintomas escola', 'professor', 'sala de aula', 'escolar'],
      'response': 'ğŸ« **Sinais na Escola**\n\n**Para Professores:**\nâ€¢ Dificuldade em seguir instruÃ§Ãµes complexas\nâ€¢ Evita atividades em grupo\nâ€¢ Comportamentos repetitivos\nâ€¢ Sensibilidade a ruÃ­dos/luzes\nâ€¢ Interesses muito especÃ­ficos\nâ€¢ Dificuldade com mudanÃ§as na rotina\n\n**EstratÃ©gias:**\nâ€¢ Use comunicaÃ§Ã£o visual\nâ€¢ Mantenha rotinas previsÃ­veis\nâ€¢ OfereÃ§a pausas sensoriais\nâ€¢ Valorize os pontos fortes\n\nğŸ“š Cada crianÃ§a Ã© Ãºnica!',
      'follow_up': ['inclusao_escolar', 'estrategias_ensino', 'direitos_escola']
    },
    
    'diagnostico': {
      'keywords': ['diagnÃ³stico', 'mÃ©dico', 'profissional', 'como diagnosticar', 'exames'],
      'response': 'ğŸ¥ **DiagnÃ³stico do TEA**\n\n**Profissionais:**\nâ€¢ Neuropediatra\nâ€¢ Psiquiatra infantil\nâ€¢ PsicÃ³logo especializado\nâ€¢ Equipe multidisciplinar\n\n**Processo:**\nâ€¢ Entrevista com famÃ­lia\nâ€¢ ObservaÃ§Ã£o comportamental\nâ€¢ Escalas padronizadas (CARS, ADI-R, ADOS)\nâ€¢ HistÃ³rico do desenvolvimento\n\n**Idade:** Pode ser feito a partir dos 18 meses\n\nâ° **DiagnÃ³stico precoce = intervenÃ§Ã£o mais eficaz!**',
      'follow_up': ['terapias', 'intervencao_precoce', 'onde_buscar_ajuda']
    },
    
    'terapias': {
      'keywords': ['terapia', 'tratamento', 'aba', 'intervenÃ§Ã£o', 'ajuda', 'como tratar'],
      'response': 'ğŸ¯ **Principais Terapias**\n\n**ABA (AnÃ¡lise do Comportamento Aplicada):**\nâ€¢ Ensina habilidades prÃ¡ticas\nâ€¢ Reduz comportamentos inadequados\nâ€¢ Baseada em evidÃªncias cientÃ­ficas\n\n**Fonoaudiologia:**\nâ€¢ Desenvolve comunicaÃ§Ã£o\nâ€¢ Trabalha linguagem verbal/nÃ£o-verbal\n\n**Terapia Ocupacional:**\nâ€¢ Atividades da vida diÃ¡ria\nâ€¢ IntegraÃ§Ã£o sensorial\n\n**Psicoterapia:**\nâ€¢ RegulaÃ§Ã£o emocional\nâ€¢ Habilidades sociais\n\n**Outras:** Musicoterapia, equoterapia, nataÃ§Ã£o\n\nâœ¨ **Cada pessoa precisa de um plano individualizado!**',
      'follow_up': ['aba_detalhes', 'fonoaudiologia', 'terapia_ocupacional']
    },
    
    'comportamentos_dificeis': {
      'keywords': ['crise', 'birra', 'agressivo', 'comportamento difÃ­cil', 'meltdown', 'autolesÃ£o'],
      'response': 'ğŸ§˜â€â™€ï¸ **Comportamentos Desafiadores**\n\n**PossÃ­veis Causas:**\nâ€¢ Sobrecarga sensorial\nâ€¢ MudanÃ§a na rotina\nâ€¢ FrustraÃ§Ã£o/comunicaÃ§Ã£o\nâ€¢ Fome, sono, dor\nâ€¢ Ansiedade\n\n**Como Ajudar:**\nâ€¢ Mantenha-se calmo\nâ€¢ Identifique o gatilho\nâ€¢ Reduza estÃ­mulos\nâ€¢ Use poucas palavras, tom suave\nâ€¢ OfereÃ§a alternativas\nâ€¢ Valide os sentimentos\n\n**PrevenÃ§Ã£o:**\nâ€¢ Rotinas previsÃ­veis\nâ€¢ ComunicaÃ§Ã£o visual\nâ€¢ Pausas regulares\nâ€¢ Ambiente organizado\n\nğŸ’™ **NÃ£o Ã© birra - Ã© comunicaÃ§Ã£o!**',
      'follow_up': ['estrategias_comportamento', 'sobrecarga_sensorial', 'rotinas']
    },
    
    'familia_apoio': {
      'keywords': ['famÃ­lia', 'pais', 'mÃ£e', 'pai', 'como ajudar famÃ­lia', 'apoio'],
      'response': 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ **Apoio Ã  FamÃ­lia**\n\n**Para Pais:**\nâ€¢ Aceite seu filho como ele Ã©\nâ€¢ Celebre pequenas conquistas\nâ€¢ Busque informaÃ§Ã£o confiÃ¡vel\nâ€¢ Conecte-se com outras famÃ­lias\nâ€¢ Cuide da sua saÃºde mental\n\n**EstratÃ©gias PrÃ¡ticas:**\nâ€¢ Crie rotinas visuais\nâ€¢ Use interesses da crianÃ§a\nâ€¢ Tenha paciÃªncia com o desenvolvimento\nâ€¢ Documente progressos\n\n**Rede de Apoio:**\nâ€¢ Grupos de pais\nâ€¢ AssociaÃ§Ãµes de autismo\nâ€¢ Terapeutas\nâ€¢ Escola\n\nğŸ’ª **VocÃª conhece seu filho melhor que ninguÃ©m!**',
      'follow_up': ['grupos_apoio', 'autocuidado_pais', 'irmÃ£os_autismo']
    },
    
    'direitos': {
      'keywords': ['direitos', 'lei', 'benefÃ­cio', 'gratuito', 'bpc', 'carteirinha'],
      'response': 'âš–ï¸ **Direitos da Pessoa com TEA**\n\n**Lei 12.764/2012 (Berenice Piana):**\nâ€¢ Pessoa com deficiÃªncia para todos os efeitos legais\n\n**Principais Direitos:**\nâ€¢ ğŸ« Prioridade em filas e atendimentos\nâ€¢ ğŸšŒ Transporte pÃºblico gratuito\nâ€¢ ğŸ’° BPC - BenefÃ­cio de 1 salÃ¡rio mÃ­nimo\nâ€¢ ğŸ¥ Atendimento especializado no SUS\nâ€¢ ğŸ« EducaÃ§Ã£o inclusiva\nâ€¢ ğŸ’¼ Cotas no mercado de trabalho\nâ€¢ ğŸ­ Meia-entrada em eventos\n\n**Documentos:**\nâ€¢ Carteirinha de identificaÃ§Ã£o\nâ€¢ Laudo mÃ©dico\nâ€¢ CID F84\n\nğŸ“‹ **Use seus direitos!**',
      'follow_up': ['bpc_como_solicitar', 'carteirinha_autismo', 'direitos_escola']
    },
    
    'inclusao_escolar': {
      'keywords': ['inclusÃ£o', 'escola inclusiva', 'professor apoio', 'adaptaÃ§Ã£o escolar'],
      'response': 'ğŸ« **InclusÃ£o Escolar**\n\n**Direitos Garantidos:**\nâ€¢ MatrÃ­cula em escola regular\nâ€¢ Professor de apoio (se necessÃ¡rio)\nâ€¢ AdaptaÃ§Ãµes curriculares\nâ€¢ Ambiente acessÃ­vel\n\n**EstratÃ©gias para Professores:**\nâ€¢ ComunicaÃ§Ã£o visual (pictogramas)\nâ€¢ Rotinas estruturadas\nâ€¢ Pausas sensoriais\nâ€¢ Atividades baseadas em interesses\nâ€¢ Parceria com famÃ­lia\n\n**AdaptaÃ§Ãµes:**\nâ€¢ Tempo extra para atividades\nâ€¢ AvaliaÃ§Ãµes diferenciadas\nâ€¢ EspaÃ§o para autorregulaÃ§Ã£o\nâ€¢ ReduÃ§Ã£o de estÃ­mulos\n\nğŸŒŸ **InclusÃ£o beneficia toda a turma!**',
      'follow_up': ['pei_plano', 'professor_apoio', 'adaptacoes_curriculares']
    },
    
    'desenvolvimento': {
      'keywords': ['desenvolvimento', 'habilidades', 'progresso', 'melhora', 'evoluÃ§Ã£o'],
      'response': 'ğŸŒ± **Desenvolvimento no TEA**\n\n**CaracterÃ­sticas:**\nâ€¢ Cada pessoa tem seu ritmo\nâ€¢ Desenvolvimento pode ser irregular\nâ€¢ Pontos fortes e desafios Ãºnicos\nâ€¢ Potencial para crescimento sempre existe\n\n**Ãreas de Foco:**\nâ€¢ ComunicaÃ§Ã£o funcional\nâ€¢ Habilidades sociais\nâ€¢ Autonomia pessoal\nâ€¢ RegulaÃ§Ã£o emocional\nâ€¢ Interesses e talentos\n\n**Dicas:**\nâ€¢ Use os interesses como ponte\nâ€¢ Celebre pequenos progressos\nâ€¢ Mantenha expectativas realistas\nâ€¢ Foque nas potencialidades\n\nâœ¨ **Pequenos passos sÃ£o grandes vitÃ³rias!**',
      'follow_up': ['marcos_desenvolvimento', 'potencialidades', 'autonomia']
    }
  };

  static const Map<String, String> _quickResponses = {
    'oi': 'ğŸ‘‹ Oi! Sou especialista em TEA. Como posso ajudar hoje?',
    'obrigado': 'ğŸ˜Š Por nada! Sempre aqui para ajudar. Cada pessoa com autismo Ã© especial!',
    'tchau': 'ğŸ‘‹ AtÃ© logo! Lembre-se: vocÃª nÃ£o estÃ¡ sozinho nessa jornada!',
    'ajuda': 'ğŸ’¡ Posso ajudar com: sintomas, diagnÃ³stico, terapias, escola, famÃ­lia, direitos e desenvolvimento. Seja especÃ­fico!'
  };

  static String? findResponse(String message) {
    final msg = message.toLowerCase().trim();
    
    // Respostas rÃ¡pidas
    for (final entry in _quickResponses.entries) {
      if (msg.contains(entry.key)) {
        return entry.value;
      }
    }
    
    // Busca na base de conhecimento
    for (final entry in _knowledge.entries) {
      final keywords = entry.value['keywords'] as List<String>;
      for (final keyword in keywords) {
        if (msg.contains(keyword.toLowerCase())) {
          return entry.value['response'] as String;
        }
      }
    }
    
    return null;
  }
  
  static List<String> getFollowUpSuggestions(String message) {
    final msg = message.toLowerCase().trim();
    
    for (final entry in _knowledge.entries) {
      final keywords = entry.value['keywords'] as List<String>;
      for (final keyword in keywords) {
        if (msg.contains(keyword.toLowerCase())) {
          return List<String>.from(entry.value['follow_up'] ?? []);
        }
      }
    }
    
    return [];
  }
  
  static String getDefaultResponse() {
    return 'ğŸ¤– **Posso ajudar com:**\n\nâ€¢ ğŸ” Sintomas e identificaÃ§Ã£o\nâ€¢ ğŸ¥ DiagnÃ³stico\nâ€¢ ğŸ¯ Terapias e tratamentos\nâ€¢ ğŸ« Escola e inclusÃ£o\nâ€¢ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Apoio Ã  famÃ­lia\nâ€¢ âš–ï¸ Direitos\nâ€¢ ğŸŒ± Desenvolvimento\n\nğŸ’¡ **Seja especÃ­fico:** "Como identificar autismo?" ou "Que terapias funcionam?"\n\nğŸ“š **Veja tambÃ©m o Feed Educativo para mais conteÃºdo!**';
  }
}